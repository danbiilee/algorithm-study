<html>
  <head>
    <meta charset="UTF-8" />
    <title>ì¶œë ¥ê²°ê³¼</title>
  </head>
  <body>
    <script>
      /*
        Q. ëª¨ë“  ì•„ë‚˜ê·¸ë¨ ì°¾ê¸°(í•´ì‰¬, íˆ¬í¬ì¸í„°, ìŠ¬ë¼ì´ë”© ìœˆë„ìš°)
        Së¬¸ìì—´ì—ì„œ Të¬¸ìì—´ê³¼ ì•„ë‚˜ê·¸ë¨ì´ ë˜ëŠ” Sì˜ ë¶€ë¶„ë¬¸ìì—´ì˜ ê°œìˆ˜ë¥¼ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±.
        ì•„ë‚˜ê·¸ë¨ íŒë³„ì‹œ ëŒ€ì†Œë¬¸ìê°€ êµ¬ë¶„ë©ë‹ˆë‹¤. ë¶€ë¶„ë¬¸ìì—´ì€ ì—°ì†ëœ ë¬¸ìì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
      */
      function mySolution(s, t) {
        let answer = 0;

        const tHash = new Map();
        for (let x of t) {
          if (tHash.has(x)) tHash.set(x, tHash.get(x) + 1);
          else tHash.set(x, 1);
        }

        /*
          1. lt: 0 , rt: 3
          2. 3ì¹¸ì”© map ê²€ì‚¬
          3. ê²€ì‚¬ ëë‚˜ë©´ 1ì¹¸ì”© ë°€ì–´ì„œ ë‹¤ì‹œ ê²€ì‚¬
        */
        const checkAnagram = (str) => {
          const hash = new Map();
          for (let x of str) {
            if (hash.has(x)) hash.set(x, hash.get(x) + 1);
            else hash.set(x, 1);
          }

          let bool = true;
          for (let [key, value] of hash) {
            if (!tHash.has(key) || tHash.get(key) !== value) {
              bool = false;
            }
          }

          if (bool) answer++;
        };

        for (let lt = 0; lt < s.length - 2; lt++) {
          checkAnagram(s.substr(lt, t.length));
        }

        return answer;
      }

      /*
        ğŸ’¥ ì ‘ê·¼ë²•: rt ì¶”ê°€ -> ë¹„êµ -> lt ì œê±°/ì¦ê°€ -> rt ì¦ê°€/ì¶”ê°€ -> ë¹„êµ -> ...
        1. lt = 0, rt = t.length - 1
        2. sHashì— lt ~ (rt-1) ìë¦¬ê¹Œì§€ ë¨¼ì € êµ¬í•´ë‘ 
        3. sHashì— rt ìë¦¬ê°’ ì¶”ê°€í•˜ê³  sHashì™€ tHashê°€ ê°™ì€ì§€ ë¹„êµ
            -> key ê°œìˆ˜ ê°™ì€ì§€, key ì¢…ë¥˜ê°€ ê°™ì€ì§€, ê° keyì— ëŒ€í•œ ê°’ì´ ê°™ì€ì§€
        5. sHashì—ì„œ ltìë¦¬ì˜ ê°’ì„ ë¹¼ê³ , lt + 1
          *** mapì—ì„œ ê°’ì´ 0ì´ë©´ í•´ë‹¹ keyë¥¼ ì‚­ì œí•´ì£¼ê¸°
        6. rt + 1 í•˜ê³ , sHashì— rt ì¶”ê°€ -> ë¹„êµ
      */

      function compareMaps(map1, map2) {
        if (map1.size !== map2.size) return false;

        for (let [key, value] of map1) {
          if (!map2.has(key) || map2.get(key) !== value) return false;
        }

        return true;
      }

      function solution(s, t) {
        let answer = 0;
        const tHash = new Map();
        const sHash = new Map();
        const len = t.length - 1;

        // 1. tHash êµ¬í•˜ê¸°
        for (let x of t) {
          if (tHash.has(x)) tHash.set(x, tHash.get(x) + 1);
          else tHash.set(x, 1);
        }

        // 2. sHash êµ¬í•˜ê¸°: lt ~ (rt-1) ìë¦¬ê¹Œì§€
        for (let i = 0; i < len; i++) {
          const key = s[i];
          if (sHash.has(key)) sHash.set(key, sHash.get(key) + 1);
          else sHash.set(key, 1);
        }

        // 3. rt ì¶”ê°€ -> ë¹„êµ -> ...
        let lt = 0;
        for (let rt = len; rt < s.length; rt++) {
          const keyRt = s[rt];
          if (sHash.has(keyRt)) sHash.set(keyRt, sHash.get(keyRt) + 1);
          else sHash.set(keyRt, 1);

          if (compareMaps(tHash, sHash)) answer++;

          const keyLt = s[lt++];
          const value = sHash.get(keyLt) - 1;
          if (value === 0) sHash.delete(keyLt);
          else sHash.set(keyLt, value);
        }

        return answer;
      }

      let a = "bacaAacba";
      let b = "abc";
      console.log(solution(a, b)); // 3: {bac}, {acb}, {cba}
    </script>
  </body>
</html>
